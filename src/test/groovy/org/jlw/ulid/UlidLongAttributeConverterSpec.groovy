package org.jlw.ulid

import spock.lang.Specification

class UlidLongAttributeConverterSpec extends Specification {
    def "conversion"(final long msb, final long lsb) {
        when:
        var ulid = new ULID(msb, lsb)

        and:
        long[] array = [msb, lsb]

        then:
        new UlidLongAttributeConverter().convertToDatabaseColumn(ulid) == array
        new UlidLongAttributeConverter().convertToEntityAttribute(array) == ulid

        where:
        msb                | lsb
        106488908812075305 | -4319074297954495403
        106488908812472562 | 6572592153539793428
        106488908812582212 | 8044406689517789089
        106488908812532456 | -8530477724920209271
        106488908812531945 | 8902815651882132302
        106488908812580922 | 7590718262229469868
        106488908812578650 | -3855439503401833733
        106488908812531689 | -3236540622851187374
        106488908812542931 | -7457531745653787183
        106488908812567387 | -2131976270164827955
        106488908812558036 | -3290583620705089743
        106488908812607746 | -2330995220813317111
        106488908812589037 | -210475388775447952
        106488908812597086 | -204248045653603675
        106488908812625946 | -4849753891595863982
        106488908812655775 | 2336043870035427907
        106488908812672180 | 3846502394207342721
        106488908812668771 | 3176672949875242721
        106488908812075305 | -4319074297954495403
        106488908812472562 | 6572592153539793428
        106488908812582212 | 8044406689517789089
        106488908812532456 | -8530477724920209271
        106488908812531945 | 8902815651882132302
        106488908812580922 | 7590718262229469868
        106488908812578650 | -3855439503401833733
        106488908812531689 | -3236540622851187374
        106488908812542931 | -7457531745653787183
        106488908812567387 | -2131976270164827955
        106488908812558036 | -3290583620705089743
        106488908812607746 | -2330995220813317111
        106488908812589037 | -210475388775447952
        106488908812597086 | -204248045653603675
        106488908812625946 | -4849753891595863982
        106488908812655775 | 2336043870035427907
        106488908812672180 | 3846502394207342721
        106488908812668771 | 3176672949875242721
    }

    def "bad ulid"(final long[] value) {
        when:
        new UlidLongAttributeConverter().convertToEntityAttribute(value)

        then:
        thrown(IllegalArgumentException.class)

        where:
        value << [
                [106488908812075305],
                [106488908812472562],
                [106488908812582212],
                [106488908812532456],
                [106488908812531945],
                [106488908812580922],
                [106488908812578650],
                [106488908812531689],
                [106488908812542931],
                [106488908812567387],
                [106488908812558036],
                [106488908812607746],
                [106488908812589037]
        ]
    }
}
